<html>
  <head>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;900&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @keyframes animateSide{
      0%{
        margin-left: -260px;
      }
      100%{
        margin-left: 0px;
      }
    }
    @keyframes animateSideBack{
      0%{
        margin-left: 0;
      }
      100%{
        margin-left: -260px;
      }
    }
    #animate-nav{
      animation: animateSide 1s forwards;
    }
    #animate-nav-def{
      animation: none;
    }
    #unanimate-nav{
      animation: animateSideBack 1s forwards;
    }
    ::-webkit-scrollbar{
      width: 10px;
    }

    @keyframes viewCheck{
      0%{
        height: 0%;
      }
      100%{
        height: 10%;
      }
    }

    @keyframes unviewCheck{
      0%{
        height: 10%;
      }
      100%{
        height: 0%;
      }
    }

    ::-webkit-scrollbar-thumb{
      border: 0px solid;
      background-color: #d1d1d1;
    }
  </style>
  </head>
  <body style="margin: 0px;" onload="loadFlights()">
    <div style="width: 100vw; height: 60px; background-color: #e60f0f;">
      <center>
      <div style="width: 90%; height: 55px; position: relative; ">
        <img src="hamburger.png" style="width: 40px; position: absolute; left: 0px; top: 10px;" onclick="animateNav('true')">
        <img src="profile.png" onclick="profile()" style="width: 30px; position: absolute; right: 3px; top: 13px;">
        <p style="font-family: Montserrat; color: white; font-weight: 700; letter-spacing: 3px; padding-top: 20px;">MY FLIGHTS</p>
      </div>
      </center>
    </div>
    <center>
      <p style="font-size: 15px; color: #e60f0f; width: 80%; font-family: Montserrat; margin-top: 30px; margin-bottom: 30px;">Below are your flights. Thanks for choosing Ace Airlines!</p>

    <div style="width: 93%; margin-top: 20px;" id="flights">
    </div>
    <div style="background-color: transparent; text-align: center; width: 100%; height: auto; position: absolute; margin-bottom: 20px;">
      <p onclick="clearFlights()" style="display: inline-block; font-size: 20px; color: #e60f0f; width: auto; font-family: Montserrat;">ðŸ—‘ </p>
      <p onclick="clearFlights()" style="display: inline-block; font-size: 15px; color: #e60f0f; width: auto; font-family: Montserrat;">Clear Flights</p>
      </div>
    </center>
      <!--navigation-->
      <div id="unanimate-nav-def" style="width: 250px; background-color: #d6d6d6; height: 100vh; position: absolute; top: 0px; left: 0px; box-shadow: 0 0 20px rgba(0, 0, 0, 0.4); margin-left: -260px">
          <img src="backArrowNav.png" style="position: absolute; top: 30px; right: 30px; width: 10px;" onclick="unanimateNav()">
          <img src="acelogo.png" style="width: 120px; margin: 20px;">
          <h1 style="font-size: 170%; color: #e60f0f; margin: 0px; margin-left: 20px; font-family: Montserrat; margin-right: 10px;">Navigation</h1>
          <button style="text-align: left; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; margin: 0px; margin-top: 25px; margin-left: 20px; border-radius: 4px; font-family: Montserrat;" onclick="window.location='/home'">HOME</button>
          <button style="text-align: left; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; margin: 0px; margin-top: 10px; margin-left: 20px; border-radius: 4px; font-family: Montserrat;" onclick="window.location = '/news'">NEWS</button>
          <button style="text-align: left; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; margin: 0px; margin-top: 10px; margin-left: 20px; border-radius: 4px; font-family: Montserrat;" onclick="window.location='/book-a-flight'">BOOK NOW</button>
          <button style="text-align: left; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; margin: 0px; margin-top: 10px; margin-left: 20px; border-radius: 4px; font-family: Montserrat;" onclick="window.location='/my-flights'">MY FLIGHTS</button>
          <button style="text-align: left; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; margin: 0px; margin-top: 10px; margin-left: 20px; border-radius: 4px; font-family: Montserrat;" onclick="window.location = 'https://flyaceairline.weebly.com/'">WEBSITE</button><!--
          --><button style="position: absolute; margin-left: 18px; bottom: 40px; text-align: left; left: 0px; color: #e60f0f; width: 150px; height: 30px; background-color: transparent; border: none; border-radius: 4px; font-family: Montserrat;" onclick="window.location='/'">Log Out</button>
          <i style="position: absolute; color: #e60f0f; bottom: 20px; left: 20px; font-family: Montserrat; font-size: 12px;">Copyright Ace Airlinesâ„¢ 2020</i>
      </div>
    </div>
    <!--viewCheckDiv-->
    <div id="viewCheckDiv" style="text-align: center; height: 0%; position: absolute; left: 0; bottom: 0; width: 100%; background-color: #e60f0f; display: none;">
    </div>
    <!--Profile-->
    <div id="profileDiv" style="display: none; width: 100vw; height: 100vh; background-color: rgba(255, 255, 255, 0.9); position: fixed; top: 0px; left: 0px; z-index: 1000;">
      <div style="width: 300px; height: 270px; background-color: white; position: absolute; top: 20px; right: 50%; margin-right: -150px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.4); border-radius: 5px; top: 50%; margin-top: -115px;">
        <p style="position: absolute; font-family: Montserrat; top: 3px; right: 15px; color: black; margin: 0px; font-size: 35px;" onclick="document.getElementById('profileDiv').style.display = 'none'">&times;</p>
        <img src="acelogo.png" style="width: 60px; padding: 10px; margin-left: 10px;">
        <p style="font-family: Montserrat; font-weight: 600; color: #e60f0f; position: absolute; top: 0px; left: 100px;">Your Profile</p>
        <p style="font-family: Montserrat; font-weight: 600; color: black; position: absolute; top: 55px; left: 20px; font-size: 14px; width: 255px; text-align: center;">You can access you flights by clicking the button below.</p>
        <button type="button" style="width: 255px; height: 35px; border-radius: 20px; background-color: #e60f0f; border: none; position: absolute; left: 20px; top: 150px; box-shadow: 0 0 20px rgba(230, 15, 15, 0.4); color: white; font-family: Montserrat;" onclick="window.location='/my-flights'">MY FLIGHTS</button>
        <button type="button" style="width: 255px; height: 35px; border-radius: 20px; background-color: #e60f0f; border: none; position: absolute; left: 20px; top: 200px; box-shadow: 0 0 20px rgba(230, 15, 15, 0.4); color: white; font-family: Montserrat;" onclick="window.location='/'">LOG OUT</button>
      </div>
    </div>

    <!--Alert-->
    <div id="alertDiv" style="display: none; width: 100vw; height: 100vh; background-color: rgba(255, 255, 255, 0.9); position: fixed; top: 0px; left: 0px; z-index: 1000;">
      <div style="width: 300px; height: 120px; background-color: white; position: absolute; top: 20px; right: 50%; margin-right: -150px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.4); border-radius: 5px; top: 50%; margin-top: -115px;">
        <p style="position: absolute; font-family: Montserrat; top: 3px; right: 15px; color: black; margin: 0px; font-size: 35px;" onclick="document.getElementById('alertDiv').style.display = 'none'">&times;</p>
        <p style="font-family: Montserrat; font-weight: 600; color: black; position: absolute; top: 30px; left: 20px; font-size: 14px; width: 255px; text-align: center;">Please close the currently open flight. You can do this by clicking on the flight.</p>
      </div>
    </div>
    <p id="name" style="display: none;">{{name}}</p>
    <p id="date" style="display: none;">{{date}}</p>
    <p id="type" style="display: none;">{{flightType}}</p>
    <p id="flightShort" style="display: none">{{short}}</p>
  </body>
<script src="/socket.io/socket.io.js"></script>
  <script>
    function view(name, date, type) {
      window.location = '/flightStatus?name=' + name + '&date=' + date + '&type=' + type + "&short=" + document.getElementById('flightShort').innerHTML
    }

    var socket = io()
    var time = 0;
    const animateNav = () => {
      time++
      if (time == 1){
        document.getElementById("unanimate-nav-def").id = "animate-nav";
      } else {
        document.getElementById("unanimate-nav").id = "animate-nav";
      }
    }

    const unanimateNav = () => {
      document.getElementById("animate-nav").id = "unanimate-nav";
    }
    function profile() {
      document.getElementById("profileDiv").style.display = "block"
    }
    var inst = 0
    var rInst = 0
    socket.on('return-destination-load', (data, status) => {
      inst++
      console.log(data)
      var newFlight = document.createElement('div')
      newFlight.style.width = "100%"
      newFlight.style.height = "60px"
      newFlight.style.borderRadius = "7px"
      newFlight.style.boxShadow = "0 0 10px rgba(0, 0, 0, 0.4)"
      newFlight.style.marginTop = "20px"
      newFlight.style.borderLeft = "10px solid #e60f0f"
      newFlight.style.textAlign = "left"
      newFlight.style.position = "relative";
      newId = 'flight' + (document.getElementById('flights').childElementCount + 1)
      newFlight.setAttribute('id', newId)
      newFlight.setAttribute('onclick', "viewCheck(" + inst + ")")
      document.getElementById('flights').appendChild(newFlight)

      var appendName = document.createElement("p")
      appendName.innerHTML = data.flightName
      var nameId = newId + '-name'
      appendName.style.color = "#e60f0f"
      appendName.style.fontFamily = "Montserrat" 
      appendName.style.fontWeight = "600" 
      appendName.style.fontSize = "13px" 
      appendName.style.marginLeft = "55px" 
      appendName.style.position = "absolute" 
      appendName.style.top = "0px" 
      appendName.style.marginTop = "7px";
      document.getElementById(newId).appendChild(appendName)

      var appendName2 = document.createElement("p")
      appendName2.innerHTML = data.flightDate
      appendName2.style.fontFamily = "Montserrat" 
      appendName2.style.fontWeight = "300" 
      appendName2.style.fontSize = "13px" 
      appendName2.style.marginLeft = "55px" 
      appendName2.style.position = "absolute" 
      appendName2.style.top = "0px" 
      appendName2.style.marginTop = "22px";
      document.getElementById(newId).appendChild(appendName2)

      var appendName3 = document.createElement("p")
      appendName3.innerHTML = data.flightType
      appendName3.style.fontFamily = "Montserrat" 
      appendName3.style.fontWeight = "600" 
      appendName3.style.fontSize = "13px" 
      appendName3.style.marginLeft = "55px" 
      appendName3.style.position = "absolute" 
      appendName3.style.top = "0px" 
      appendName3.style.marginTop = "37px";
      document.getElementById(newId).appendChild(appendName3)

      var name = data.flightName
      var date = data.flightDate
      var type = data.flightType

      var view = document.createElement('p')
      view.innerHTML = "VIEW"
      view.style.color = "white"
      view.style.fontFamily = "Montserrat"
      view.style.fontWeight = "600"
      view.style.fontSize = "13px"
      view.style.border = "1px solid white"
      view.style.borderRadius = "7px"
      view.style.right = "35%"
      view.style.zIndex = "100"
      view.style.marginRight = "-40px"
      view.style.position = "fixed"
      view.style.bottom = "10px"
      view.id = inst.toString() + "view"
      view.style.display = "none"
      if (status == "false") {
        view.style.right = "35%"
      } else if (status == "true") {
        view.style.right = "50%"
      }
      view.style.backgroundColor = "transparent"
      view.style.padding = "10px"
      view.style.borderRadius = "7px"
      view.addEventListener('click', () => window.location = '/flightStatus?name=' + name + '&date=' + date + '&type=' + type + "&username=" + localStorage.getItem('username'));
      console.log("hello")
      document.getElementById(newId).appendChild(view)
      if (status == "false") {
        var checkin = document.createElement('p')
        checkin.innerHTML = "CHECK IN"
        checkin.id = inst.toString() + "checkin"
        checkin.style.color = "white"
        checkin.style.fontFamily = "Montserrat"
        checkin.style.fontWeight = "600"
        checkin.style.fontSize = "13px"
        checkin.style.marginLeft = "-40px"
        checkin.style.left = "35%"
        checkin.style.zIndex = "100"
        checkin.style.position = "fixed"
        checkin.style.bottom = "10px"
        checkin.style.marginTop = "21px"
        checkin.style.backgroundColor = "transparent"
        checkin.style.padding = "10px"
        checkin.style.border = "1px solid white"
        checkin.style.borderRadius = "7px"
        checkin.style.display = "none"
        checkin.addEventListener('click', () => window.location = '/check-in?name=' + name + "&username=" + localStorage.getItem('username') + "&date=" + date + "&type=" + type + "&short=" + document.getElementById('flightShort').innerHTML)
        document.getElementById(newId).appendChild(checkin)
      } else {

      }

      var renderImage = document.createElement('img')
      renderImage.setAttribute('src', 'airplaneLogo.png')
      renderImage.style.width = "45px" 
      renderImage.style.position = "absolute" 
      renderImage.style.top = "50%" 
      renderImage.style.marginTop = "-22.5px" 
      renderImage.style.marginLeft = "5px"
      document.getElementById(newId).appendChild(renderImage)
    })

    function loadFlights() {
      if (document.getElementById('name').innerHTML == "") {
         socket.emit('request-destination-load', localStorage.getItem('username'))
      } else {
        rInst++
        var name = document.getElementById('name').innerHTML
        var date = document.getElementById('date').innerHTML
        var type = document.getElementById('type').innerHTML
        var newFlight = document.createElement('div')
        newFlight.style.width = "100%"
        newFlight.style.height = "60px"
        newFlight.style.borderRadius = "7px"
        newFlight.style.boxShadow = "0 0 10px rgba(0, 0, 0, 0.4)"
        newFlight.style.marginTop = "20px"
        newFlight.style.borderLeft = "10px solid #e60f0f"
        newFlight.style.textAlign = "left"
        newFlight.style.position = "relative";
        var newId = 'flight' + (document.getElementById('flights').childElementCount + 1)
        newFlight.setAttribute('id', newId)
        document.getElementById('flights').appendChild(newFlight)

        var appendName = document.createElement("p")
        appendName.innerHTML = name
        appendName.style.color = "#e60f0f"
        appendName.style.fontFamily = "Montserrat" 
        appendName.style.fontWeight = "600" 
        appendName.style.fontSize = "13px" 
        appendName.style.marginLeft = "55px" 
        appendName.style.position = "absolute" 
        appendName.style.top = "0px" 
        appendName.style.marginTop = "7px";
        document.getElementById(newId).appendChild(appendName)

        var appendName2 = document.createElement("p")
        appendName2.innerHTML = date
        appendName2.style.fontFamily = "Montserrat" 
        appendName2.style.fontWeight = "300" 
        appendName2.style.fontSize = "13px" 
        appendName2.style.marginLeft = "55px" 
        appendName2.style.position = "absolute" 
        appendName2.style.top = "0px" 
        appendName2.style.marginTop = "22px";
        document.getElementById(newId).appendChild(appendName2)

        var view = document.createElement('p')
        view.innerHTML = "VIEW"
        view.style.color = "white"
        view.style.fontFamily = "Montserrat"
        view.style.fontWeight = "600"
        view.style.fontSize = "13px"
        view.style.right = "35%"
        view.style.marginRight = "-40px"
        view.style.zIndex = "100"
        view.style.position = "fixed"
        view.style.bottom = "10px"
        view.style.display = "none"
        view.id = rInst.toString() + "view"
        view.style.backgroundColor = "transparent"
        view.style.padding = "10px"
        view.style.border = "1px solid white"
        view.style.borderRadius = "7px"
        view.addEventListener('click', () => window.location = '/flightStatus?name=' + name + '&date=' + date + '&type=' + type + "&short=" + document.getElementById('flightShort').innerHTML + "&username=" + localStorage.getItem('username'));
        console.log("hello")
        document.getElementById(newId).appendChild(view)

        var checkin = document.createElement('p')
        checkin.innerHTML = "CHECK IN"
        checkin.style.color = "white"
        checkin.id = rInst.toString() + "checkin"
        checkin.style.fontFamily = "Montserrat"
        checkin.style.fontWeight = "600"
        checkin.style.fontSize = "13px"
        checkin.style.marginLeft = "-40px"
        checkin.style.left = "35%"
        checkin.style.position = "fixed"
        checkin.style.bottom = "10px"
        checkin.style.zIndex = "100"
        checkin.style.marginTop = "21px"
        checkin.style.backgroundColor = "transparent"
        checkin.style.padding = "10px"
        checkin.style.border = "1px solid white"
        checkin.style.borderRadius = "7px"
        checkin.style.display = "none"
        checkin.addEventListener('click', () => window.location = '/check-in?name=' + name + "&username=" + localStorage.getItem('username') + "&date=" + date + "&type=" + type + "&short=" + document.getElementById('flightShort').innerHTML)
        document.getElementById(newId).appendChild(checkin)

        var renderImage = document.createElement('img')
        renderImage.setAttribute('src', 'airplaneLogo.png')
        renderImage.style.width = "45px" 
        renderImage.style.position = "absolute" 
        renderImage.style.top = "50%" 
        renderImage.style.marginTop = "-22.5px" 
        renderImage.style.marginLeft = "5px"
        document.getElementById(newId).appendChild(renderImage)

        window.location = '/save-flights?name=' + name + '&date=' + date + '&type=' + type + '&username=' + localStorage.getItem('username') + '&short=' + document.getElementById('flightShort').innerHTML + "&email=" + localStorage.getItem('user-email')
      }
    }
    function clearFlights() {
      window.location = "/delete-flights?username=" + localStorage.getItem("username")
    }
    
function viewCheck(inst) {
  console.log(inst + " " + rInst)
  var show = document.getElementById("viewCheckDiv");
  var viewText = document.getElementById(inst.toString() + "view");
  var checkText = document.getElementById(inst.toString() + "checkin");
  
  if (viewText.style.display === "none") { 
    if (show.offsetHeight === 0) { 
    show.style.animation = "viewCheck 1s forwards";
    show.style.display = "block";
    viewText.style.display = "block";
    checkText.style.display = "block";

  } else {
    document.getElementById("alertDiv").style.display = "block";
  }

  } else {
    show.style.animation = "unviewCheck 0.5s forwards";
    viewText.style.display = "none";
    checkText.style.display = "none";
  }
}
  </script>
</html>